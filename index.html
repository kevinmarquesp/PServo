<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PServo: PServo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PServo<span id="projectnumber">&#160;v0.2.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">PServo </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> An Arduino library designed to make working with multiple servo motors simpler and more intuitive, especially for those building complex robots. With PServo, you can easily control the movements of multiple servos at the same time and even create more advanced motion sequences. The library introduces a design pattern that I call Scene-Oriented Programming, making it easier to choreograph and synchronize servo movements for your projects.</p>
<div class="image">
<img src="demo.gif" alt=""/>
<div class="caption">
PServo demo</div></div>
    <h1><a class="anchor" id="autotoc_md1"></a>
Installation</h1>
<p>PServo is built as a <em>state machine</em>, so it requires the <code>Servo.h</code> library to function properly. Make sure you have that installed as well.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Option 1: Manual Installation</h2>
<ul>
<li>Visit the <a href="https://github.com/kevinmarquesp/PServo/releases">releases page</a> on GitHub.</li>
<li>Download the <code>.zip</code> file for the version you want.</li>
<li>Extract the <code>.zip</code> file into your Arduino libraries folder:<ul>
<li>On Linux or Mac: <code>~/Arduino/libraries</code></li>
<li>On Windows: <code>Documents\Arduino\libraries</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Option 2: Using Arduino CLI (Recommended)</h2>
<p>If you prefer a faser method, you can use the following <a href="https://arduino.github.io/arduino-cli/1.0/">Arduino CLI</a> command:</p>
<div class="fragment"><div class="line">arduino-cli lib install --git-url https://github.com/kevinmarquesp/PServo</div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;[!NOTE] If you haven’t configured the Arduino CLI to allow unsafe library installations, you might need to follow <a href="https://arduino.github.io/arduino-cli/0.35/configuration/#configuration-keys">this documentation</a> to enable it. In short, run <code>arduino-cli config init</code>, open the generated file, and set <code>library.enable_unsafe_install</code> to <code>true</code>. That’s it! </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md4"></a>
Usage</h1>
<p>This library doesn’t use the <code>delay()</code> function to control the speed of movements, as it would pause the entire program, which isn’t suitable for most Arduino applications. Instead, it relies on the <code>millis()</code> function to determine when to wait and when to execute movements, similar to other Arduino projects.</p>
<p>The general structure of your application should look something like this:</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> timer = 0;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">// ...rest of the code...</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop(<span class="keywordtype">void</span>) {</div>
<div class="line">  timer = millis();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// ...rest of the code...</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>First, import the <code>Servo.h</code> and <code><a class="el" href="PServo_8h_source.html">PServo.h</a></code> libraries, then create the servo objects you want to control, along with a PServo object for each servo. The PServo object will calculate the servo position, and you'll need to update the actual servo object with these calculated values.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;Servo.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;PServo.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> timer = 0;</div>
<div class="line"> </div>
<div class="line">Servo servo_right;</div>
<div class="line">Servo servo_left;</div>
<div class="line"> </div>
<div class="line">PServo machine_right(&amp;timer, 0, 180, <span class="keyword">true</span>);</div>
<div class="line">PServo machine_left(&amp;timer, 0, 180, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup(<span class="keywordtype">void</span>) {</div>
<div class="line">  servo_right.attach(7);</div>
<div class="line">  servo_left.attach(6);</div>
<div class="line">}</div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;In this example, the line <code>PServo machine_left(&amp;timer, 0, 180, true);</code> initializes a PServo object with a minimum value of 0, a maximum value of 180, and the <code>true</code> parameter indicates that this machine allows looping. When the movement sequence ends, it will automatically restart. </p>
</blockquote>
<p>Since the <code>timer</code> pointer lets the PServo object track the current time in your application, you'll need to update the servo positions within the <code>loop()</code> function. The process involves getting the current position from each PServo object and then writing that position to the corresponding servo object:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> loop(<span class="keywordtype">void</span>) {</div>
<div class="line">    timer = millis();</div>
<div class="line"> </div>
<div class="line">    servo_right.write(machine_right.get_pos());</div>
<div class="line">    servo_left.write(machine_left.get_pos());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ...rest of the code...</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>To configure the moveset for the servos, start with the <code>.begin()</code> method, followed by a series of <code>move()</code> calls. The <code>.begin()</code> method indicates the start of a new movement sequence, while each <code>move()</code> method specifies a movement to be performed. The PServo object will manage which movement is currently active and which should be skipped. It’s important to define this moveset within the <code>loop()</code> function:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> loop(<span class="keywordtype">void</span>) {</div>
<div class="line">    <span class="comment">// ...rest of the code...</span></div>
<div class="line"> </div>
<div class="line">    machine_right.begin();</div>
<div class="line">    machine_right.move(180, 15);  <span class="comment">// Go to 180º waiting 15 ms for each deg update.</span></div>
<div class="line">    machine_right.move(0, 20);    <span class="comment">// Go to 0º waiting 0 ms for each deg update.</span></div>
<div class="line"> </div>
<div class="line">    machine_left.begin();</div>
<div class="line">    machine_left.move(180, 20);</div>
<div class="line">    machine_left.move(0, 0);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Since repeatedly writing the machine name can be tedious, this library provides a syntax shortcut to simplify your code. The following code does the same as the one above:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> loop(<span class="keywordtype">void</span>) {</div>
<div class="line">    <span class="comment">// ...rest of the code...</span></div>
<div class="line"> </div>
<div class="line">    machine_right.begin()</div>
<div class="line">        -&gt;move(180, 15)</div>
<div class="line">        -&gt;move(0, 20);</div>
<div class="line"> </div>
<div class="line">    machine_left.begin()</div>
<div class="line">        -&gt;move(180, 20)</div>
<div class="line">        -&gt;move(0, 0);</div>
<div class="line">}</div>
</div><!-- fragment --><p>This is just a basic example. For more details on what this library can do and how to implement additional features, check out the <a href="https://kevinmarquesp.github.io/PServo/">official documentation</a> and the <a href="https://github.com/kevinmarquesp/PServo/tree/main/examples">example sketches</a> to learn more.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Contributing</h1>
<p>If you’d like to contribute to the development of PServo, follow these steps:</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Getting Started</h2>
<ol type="1">
<li>Clone the repository:</li>
</ol>
<div class="fragment"><div class="line">git clone https://github.com/kevinmarquesp/PServo</div>
<div class="line">cd PServo</div>
</div><!-- fragment --><ol type="1">
<li>Set up dependencies:</li>
</ol>
<div class="fragment"><div class="line">make deps # Clone and/or build vendorized libraries.</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
Testing (Arduino Board not Required)</h2>
<p>You can run tests without needing an Arduino board.</p>
<h3><a class="anchor" id="autotoc_md8"></a>
Run All Tests</h3>
<p>To run the entire test suite:</p>
<div class="fragment"><div class="line">make deps</div>
<div class="line">make test</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md9"></a>
Run a Specific Test</h3>
<p>To run a specific test, specify the test file with the <code>GTEST_UNITS</code> variable:</p>
<div class="fragment"><div class="line">make deps</div>
<div class="line">make test GTEST_UNITS=extra/gtest/test_gtest.cpp</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
